<!DOCTYPE html><html><head><title>Customer Service with Twilio Video</title><style>body, html {
  height:100%;
  width:100%;
  padding:0;
  margin:0;
  overflow:hidden;
  background-color:#ddd;
}
.wrapper {
  height:100%;
  width:100%;
}</style><link rel="shortcut icon" href="//twilio.com/bundles/marketing/img/favicons/favicon.ico"><link rel="apple-touch-icon" href="//twilio.com/bundles/marketing/img/favicons/favicon_57.png"><link rel="apple-touch-icon" sizes="72x72" href="//twilio.com/bundles/marketing/img/favicons/favicon_72.png"><link rel="apple-touch-icon" sizes="114x114" href="//twilio.com/bundles/marketing/img/favicons/favicon_114.png"><link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css"><link rel="stylesheet" href="viewsaurus.css"></head><body><div class="wrapper"><div id="viewsaurus" data-title="Customer Service with Twilio Video"><div class="saurus-panes"><div class="saurus-prose"><div class="saurus-prose-header"><div class="title-outer"><span class="step-title">Customer Service with Twilio Video</span></div></div><div class="saurus-nav-buttons"><div class="saurus-nav-button nav-overview"><div class="saurus-nav-button-inner"><i class="fa fa-fw fa-list"></i></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-previous"><div class="saurus-nav-button-inner"><a href=""> <i class="fa fa-fw fa-play fa-rotate-180"></i></a></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-next clickable"><div class="saurus-nav-button-inner"><a href="#1"> <i class="fa fa-fw fa-play"></i></a></div></div><div class="saurus-next-title"><span class="next-title-inner"></span></div></div><div class="saurus-progress-bar"></div><div class="saurus-start"><p>In this tutorial, we'll show you the code necessary to create amazing in-context customer support experiences using Twilio Video. Let's get started!</p><a href="#0">Start Tutorial</a></div><div class="saurus-content"><div data-title="Customer Service with Twilio Video" class="chapter"><div data-title="Customer Service with Twilio Video" class="step"><h2 id="customer-service-with-twilio-video">Customer Service with Twilio Video</h2>
<p>In this tutorial, we&#39;ll dive into the code necessary to implement in-context customer support with Twilio Video. In this demo application, a customer will request live video support while viewing a product page on our website. In a separate &quot;support agent&quot; UI, we will display all current requests for support, and allow our agents to reach out directly and assist our customers.</p>
<p>Sound like fun? Let's figure out how it works! Click the <i class="fa fa-fw fa-play"></i> button above to move on to the next step of the tutorial.
</p></div><div data-title="About This Application" data-file="package.json" data-highlight="27-41" class="step"><h2 id="about-this-application">About This Application</h2>
<p>This web application was built with <a href="http://nodejs.org">Node.js</a> and the popular <a href="http://expressjs.com">Express</a> web framework, along with a few other useful open source components. We&#39;re going to save our support requests in <a href="http://www.mongodb.com/">MongoDB</a> with the help of <a href="http://mongoosejs.com/">Mongoose</a>, a handy module for creating <a href="http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller">model</a> objects that are saved in MongoDB.</p>
<p>Of course, we&#39;ll also be using Twilio&#39;s module for Node.js, as well as Twilio&#39;s JavaScript SDK in the browser.</p>
<h3 id="run-it-now">Run It Now</h3>
<p>Want to run it yourself right now? Deploy this app to your Heroku account using the button below:</p>
<p><a href="https://heroku.com/deploy?template=https://github.com/TwilioDevEd/video-service-node"><img src="https://www.herokucdn.com/deploy/button.png" alt="Deploy"></a></p>
<p>Now that we have a better sense of what&#39;s in the box, let&#39;s move on to building the customer-facing portion of this application. </p>
</div></div><div data-title="Customer View: Requesting Video Support" class="chapter"><div data-title="Requesting Live Video Support" data-file="controllers/router.js" class="step"><h2 id="requesting-live-video-support">Requesting Live Video Support</h2>
<p>Let&#39;s begin our exploration of live video support by looking at the customer-facing side of this application.  Here&#39;s how that interaction works at a high level (click to make it bigger):</p>
<p><img src="//s3.amazonaws.com/howtodocs/video-service-customer-flow.png" alt="//s3.amazonaws.com/howtodocs/video-service-customer-flow.png"></p>
<p>To request video support, our user must:</p>
<ol>
<li>Visit a product page</li>
<li>Click a button to request live support</li>
<li>Wait for the next available agent</li>
</ol>
<p>Let&#39;s take a look at the code necessary to drive each step of this experience.</p>
</div><div data-title="Choosing a Product" data-file="controllers/router.js" data-highlight="20-21" class="step"><h2 id="choosing-a-product">Choosing a Product</h2>
<p>Our example product catalog is a list of starships fetched via the <a href="http://swapi.co/api/starships/">Star Wars API</a>.</p>
<p>We won&#39;t dive into this code in any great detail, but we&#39;ll use this API both to display a list of starships to the User, and to show them details about an individual ship. You might have one of these master-detail UIs in your existing application.</p>
<p>The Express route highlighted here will display a table of links that the User can choose from to show a detail page, where they will be able to request support. When you&#39;re making a big purchase like an Incom T-65 X-Wing Starfighter, that&#39;s definitely a time when you&#39;d value high-touch support.</p>
<p><img src="//s3.amazonaws.com/howtodocs/xwing-blueprint.jpg" alt="//s3.amazonaws.com/howtodocs/xwing-blueprint.jpg"></p>
</div><div data-title="Rendering a Product Page: The Route" data-file="controllers/router.js" data-highlight="23-24" class="step"><h2 id="rendering-a-product-page-the-route">Rendering a Product Page: The Route</h2>
<p>This route will handle requests for all the individual product pages. There&#39;s a controller function <code>products.detail</code> which handles actually fetching product details from the Star Wars API, and including them on the rendered page.</p>
<p>However, we&#39;re more interested in the <code>token</code> <a href="http://expressjs.com/guide/using-middleware.html">middleware function</a>, which will generate a one-time use access token that enables any viewer of the page to receive an incoming video call. Let&#39;s dive into that code now.</p>
</div><div data-title="Rendering a Product Page: Token Middleware" data-file="middleware/token.js" data-highlight="25-57" class="step"><h2 id="rendering-a-product-page-the-token-middleware">Rendering a Product Page: The Token Middleware</h2>
<p>This middleware function will be executed before every product page is rendered. It will use Twilio&#39;s helper library for Node.js to generate a one-time use token that authorizes a connected browser to receive incoming calls via Twilio. It also generates a unique ID for this client using the <code>uuid</code> module - we&#39;ll use this as the &quot;phone number&quot; for our customer, where we know we can reach them later. We store both of these values as local variables in the context of our HTTP response, so we can render them in our Jade templates.</p>
<p>Let&#39;s jump up to the client-side now, where we can see how this token is used on the product page.</p>
</div><div data-title="Rendering a Product Page: The Template" data-file="views/detail.jade" class="step"><h2 id="rendering-a-product-page-the-template">Rendering a Product Page: The Template</h2>
<p>To render the product page, we will make use of two partial templates, <code>_ship_detail</code> and <code>_video</code>. The former will display information about the current ship. The latter will embed a video chat widget which will be used both on our customer&#39;s product detail page, and on the support agent&#39;s page (which we&#39;ll look at later).</p>
<p>Let&#39;s check out this partial template to see what it looks like.</p>
</div><div data-title="Video Partial" data-file="views/_video.jade" class="step"><h2 id="video-partial">Video Partial</h2>
<p>This template creates the HTML  elements that our two conversation participants will be shown in. We also include the Twilio Video SDK from a CDN, which will include all of the Twilio API in the window scope.</p>
</div><div data-title="Inserting Capability Tokens and Customer's Unique ID" data-file="views/_video.jade" data-highlight="8-14" class="step"><h2 id="inserting-capability-tokens-and-customer-s-unique-id">Inserting Capability Tokens and Customer&#39;s Unique ID</h2>
<p>Here, we insert two values generated on the server into <code>script</code> tags, which will allow our JavaScript code to access them. We need both the endpoint ID for this page (uniquely identifying the person visiting it), and the secure token we generated allowing the browser to use the Twilio back end.</p>
<p>We&#39;ll go into how these values are used in depth soon, but let&#39;s finish out our look at the customer UI by showing how a support request gets created.</p>
</div><div data-title="Creating a Ticket" data-file="public/js/product.js" data-highlight="14-33" class="step"><h2 id="creating-a-ticket">Creating a Ticket</h2>
<p>On our product detail page, we load up some JavaScript that will listen for a click event on the &quot;Request Support&quot; button. This will fire off an Ajax request to the server, which will create a new support ticket in our database.  That ticket will contain both the URL for the product our customer is viewing, as well as their unique ID which we assigned on the server. </p>
<p>By capturing these values in a support ticket, our agents will be able to provide a better support experience when they finally reach out - they&#39;ll know what product the customer is looking at, and how to contact them via video chat.</p>
<p>Let&#39;s switch over to the agent side of things to see how the video support call actually gets created.</p>
</div></div><div data-title="Agent View: Answering Support Calls" class="chapter"><div data-title="Answering a Support Request" data-file="controllers/router.js" class="step"><h2 id="answering-a-support-request">Answering a Support Request</h2>
<p>Now that we&#39;ve seen how a customer can request video support, let&#39;s take a look at how we answer that request and initiate a video call.  Here&#39;s how the interaction works at a high level (click to make it bigger):</p>
<p><img src="//s3.amazonaws.com/howtodocs/video-service-agent-flow.png" alt="//s3.amazonaws.com/howtodocs/video-service-agent-flow.png"></p>
<p>Our agent will view a page for a support ticket, and the JavaScript running on that page will immediately try and connect to the customer with a video call.  The agent will also be able to view the same product details as the customer, so they can provide informed support based on where the customer is inside the application</p>
<p>Let&#39;s take a look at the code necessary to drive each step of this experience.</p>
</div><div data-title="Agent UI Routes" data-file="controllers/router.js" data-highlight="26-30" class="step"><h2 id="agent-ui-routes">Agent UI Routes</h2>
<p>To power our agent experience, we need to handle two routes - one for the list of support requests, and another to display an individual support request. Much like the product list, we won&#39;t delive too deeply into how the list of tickets is displayed. We&#39;re reading the tickets out of a database and displaying them in an HTML table.</p>
<p>Let&#39;s begin instead by looking at how we render a ticket page, the second of these two routes. We use the same <code>token</code> middleware as before to create an ID for our agent. We also fetch data from the Star Wars API to get information on the ship the current customer is viewing.</p>
<p>Most of the action for the call is happening on the client side, though, so let&#39;s dive into the browser code to see what&#39;s going on!</p>
</div><div data-title="Shared Code for Customer and Agent" data-file="public/js/video.js" class="step"><h2 id="shared-code-for-customer-and-agent">Shared Code for Customer and Agent</h2>
<p>The video partial, which is used for both the customer and the agent views, includes this JavaScript file. It adds shared logic that will be needed for both parts of the UI.  Let&#39;s check these pieces out first.</p>
</div><div data-title="Initializing the Twilio JavaScript SDK" data-file="public/js/video.js" data-highlight="26-27" class="step"><h2 id="initializing-the-twilio-javascript-sdk">Initializing the Twilio JavaScript SDK</h2>
<p>For the agent (and for customers) the first order of business is to create an <code>Endpoint</code> to represent the current person viewing the page. We create one here, passing in the window-scoped access token (JWT string) we created on the server.</p>
</div><div data-title="Accepting an Inbound Call" data-file="public/js/video.js" data-highlight="29-33" class="step"><h2 id="accepting-an-inbound-call">Accepting an Inbound Call</h2>
<p>Immediately after creating the Endpoint, we regiser a listener that will be fired on any incoming vieo call invitations. For this example, we automatically accept the invite.</p>
</div><div data-title="Displaying Video Streams" data-file="public/js/video.js" data-highlight="4-21" class="step"><h2 id="displaying-video-streams">Displaying Video Streams</h2>
<p>To display both parties in the video call, the logic is the same whether you initated the conversation, or you accepted an invitation. The Twilio JS SDK will append a video tag to an element of your choosing containing data from your own local web cam, and the stream coming from the person you are calling.</p>
</div><div data-title="Making an Outbound Call" data-file="public/js/ticket.js" data-highlight="5-8" class="step"><h2 id="making-an-outbound-call">Making an Outbound Call</h2>
<p>In the support agent UI, we immediately attempt to place an outbound call to the endpoint ID associated with the ticket. We inserted <code>ticketEndpoint</code> into the template when the agent page was displayed, much like we did with our access token.</p>
</div><div data-title="All Done!" data-file="public/js/ticket.js" class="step"><h2 id="all-done-">All Done!</h2>
<p>And with a fraction of the code and none of the infrastructure you would need to roll your own WebRTC-powered video call, we&#39;ve integrated live, in-context video support into our application. And this is just the beginning - you could combine this API with <a href="https://www.twilio.com/taskrouter">TaskRouter</a> for more advanced work distribution for your agents, and begin to leverage other WebRTC features not used here.</p>
<p>We&#39;d love to hear what you thought of this tutorial. Hit us up <a href="https://twitter.com/twilio">on Twitter @twilio</a> or <a href="mailto:help@twilio.com">send us a note</a>. Thanks for reading!</p>
</div></div>
<div class="saurus-files" style="display:none;"><textarea class="saurus-file" data-file="package.json" data-mode="json">ewogICJuYW1lIjogInZpZGVvLXNlcnZpY2Utbm9kZSIsCiAgInZlcnNpb24iOiAiMS4wLjAiLAogICJkZXNjcmlwdGlvbiI6ICJEZW1vIGFwcCBzaG93aW5nIHZpZGVvLXBvd2VyZWQgY3VzdG9tZXIgc2VydmljZSB3aXRoIFR3aWxpbyBmb3IgTm9kZS5qcyB1c2luZyB0aGUgRXhwcmVzcyB3ZWIgZnJhbWV3b3JrIiwKICAibWFpbiI6ICJpbmRleC5qcyIsCiAgInNjcmlwdHMiOiB7CiAgICAidGVzdCI6ICJtb2NoYSB0ZXN0IgogIH0sCiAgInJlcG9zaXRvcnkiOiB7CiAgICAidHlwZSI6ICJnaXQiLAogICAgInVybCI6ICJodHRwczovL2dpdGh1Yi5jb20vVHdpbGlvRGV2RWQvdmlkZW8tc2VydmljZS1ub2RlIgogIH0sCiAgImtleXdvcmRzIjogWwogICAgInR3aWxpbyIsCiAgICAiZXhwcmVzcyIsCiAgICAibW9uZ29kYiIsCiAgICAidHdpbWwiLAogICAgIndlYmhvb2tzIiwKICAgICJ2b2lwIgogIF0sCiAgImF1dGhvciI6ICJLZXZpbiBXaGlubmVyeSIsCiAgImxpY2Vuc2UiOiAiTUlUIiwKICAiYnVncyI6IHsKICAgICJ1cmwiOiAiaHR0cHM6Ly9naXRodWIuY29tL1R3aWxpb0RldkVkL3ZpZGVvLXNlcnZpY2Utbm9kZS9pc3N1ZXMiCiAgfSwKICAiaG9tZXBhZ2UiOiAiaHR0cHM6Ly9naXRodWIuY29tL1R3aWxpb0RldkVkL3ZpZGVvLXNlcnZpY2Utbm9kZSIsCiAgImRlcGVuZGVuY2llcyI6IHsKICAgICJib2R5LXBhcnNlciI6ICJeMS4xMi4wIiwKICAgICJjb25uZWN0LWZsYXNoIjogIl4wLjEuMSIsCiAgICAiZXhwcmVzcyI6ICJeNC4xMi4wIiwKICAgICJleHByZXNzLXNlc3Npb24iOiAiXjEuMTAuMyIsCiAgICAiaHR0cC1hdXRoIjogIl4yLjIuNSIsCiAgICAiamFkZSI6ICJeMS45LjIiLAogICAgIm1vbWVudCI6ICJeMi4xMC4yIiwKICAgICJtb25nb29zZSI6ICJeNC4wLjIiLAogICAgIm1vcmdhbiI6ICJeMS41LjEiLAogICAgInJlcXVlc3QiOiAiXjIuNTUuMCIsCiAgICAidHdpbGlvIjogIl4xLjExLjEiLAogICAgInVuZGVyc2NvcmUuc3RyaW5nIjogIl4zLjAuMyIsCiAgICAidXVpZCI6ICJeMi4wLjEiCiAgfSwKICAiZGV2RGVwZW5kZW5jaWVzIjogewogICAgImNoYWkiOiAiXjIuMS4wIiwKICAgICJtb2NoYSI6ICJeMi4xLjAiCiAgfSwKICAiZW5naW5lcyI6IHsKICAgICJub2RlIjogIj49IDAuMTAuMCIKICB9Cn0K</textarea>
<textarea class="saurus-file" data-file="controllers/router.js" data-mode="javascript">dmFyIHMgPSByZXF1aXJlKCd1bmRlcnNjb3JlLnN0cmluZycpOwp2YXIgbW9tZW50ID0gcmVxdWlyZSgnbW9tZW50Jyk7CnZhciBwcm9kdWN0cyA9IHJlcXVpcmUoJy4vcHJvZHVjdHMnKTsKdmFyIHN1cHBvcnRUaWNrZXRzID0gcmVxdWlyZSgnLi9zdXBwb3J0X3RpY2tldHMnKTsKdmFyIHRva2VuID0gcmVxdWlyZSgnLi4vbWlkZGxld2FyZS90b2tlbicpOwoKLy8gTWFwIHJvdXRlcyB0byBjb250cm9sbGVyIGZ1bmN0aW9ucwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGFwcCkgewogICAgLy8gSW5jbHVkZSBzdHJpbmcgZm9ybWF0IGhlbHBlcnMKICAgIGFwcC5sb2NhbHMubnVtID0gZnVuY3Rpb24obnVtLCBkaWdpdHMpIHsKICAgICAgICB2YXIgc2lnRGlnaXRzID0gTnVtYmVyKGRpZ2l0cyk7CiAgICAgICAgaWYgKGlzTmFOKHNpZ0RpZ2l0cykpIHNpZ0RpZ2l0cyA9IDI7CiAgICAgICAgcmV0dXJuIHMubnVtYmVyRm9ybWF0KE51bWJlcihudW0pLCBzaWdEaWdpdHMpOwogICAgfTsKCiAgICBhcHAubG9jYWxzLnRpbWVBZ28gPSBmdW5jdGlvbih0aW1lKSB7CiAgICAgICAgcmV0dXJuIG1vbWVudCh0aW1lKS5mcm9tTm93KHRydWUpOwogICAgfTsKCiAgICAvLyBSZW5kZXIgaG9tZSBwYWdlIChwcm9kdWN0IGxpc3QpCiAgICBhcHAuZ2V0KCcvJywgcHJvZHVjdHMubGlzdCk7CgogICAgLy8gUHJvZHVjdCBkZXRhaWwgcGFnZSwgd2hpY2ggc2hvdWxkIGluY2x1ZGUgYSBjYXBhYmlsaXR5IHRva2VuCiAgICBhcHAuZ2V0KCcvcHJvZHVjdHMnLCB0b2tlbiwgcHJvZHVjdHMuZGV0YWlsKTsKCiAgICAvLyBWaWV3IGFsbCBzdXBwb3J0IHRpY2tldHMKICAgIGFwcC5nZXQoJy90aWNrZXRzJywgc3VwcG9ydFRpY2tldHMubGlzdCk7CgogICAgLy8gU2hvdyBhIHZpZGVvIGNvbnZlcnNhdGlvbiB2aWV3IGZvciBhIHRpY2tldAogICAgYXBwLmdldCgnL3RpY2tldHMvOmlkJywgdG9rZW4sIHN1cHBvcnRUaWNrZXRzLnNob3cpOwoKICAgIC8vIENyZWF0ZSBhIHN1cHBvcnQgdGlja2V0CiAgICBhcHAucG9zdCgnL3RpY2tldHMnLCBzdXBwb3J0VGlja2V0cy5jcmVhdGUpOwp9Ow==</textarea>
<textarea class="saurus-file" data-file="middleware/token.js" data-mode="javascript">dmFyIHV0aWwgPSByZXF1aXJlKCd1dGlsJyk7CnZhciB1dWlkID0gcmVxdWlyZSgndXVpZCcpOwp2YXIgdHdpbGlvID0gcmVxdWlyZSgnLi4vdHdpbGlvJyk7CnZhciBjb25maWcgPSByZXF1aXJlKCcuLi9jb25maWcnKTsKdmFyIGNsaWVudCA9IHR3aWxpbyhjb25maWcuYWNjb3VudFNpZCwgY29uZmlnLmF1dGhUb2tlbik7CgovLyBGZXRjaCBhIHNpZ25pbmcga2V5IGZyb20gdGhlIFR3aWxpbyBSRVNUIEFQSSwgd2hpY2ggd2UnbGwgdXNlIHRvIG1pbnQgb3VyIAovLyBhY2Nlc3MgdG9rZW5zIGJlbG93IGluIGV4cG9ydHMuZ2VuZXJhdGVUb2tlbgp2YXIgU0lHTklOR19LRVlfU0lELCBTSUdOSU5HX0tFWV9TRUNSRVQ7CgovLyBDcmVhdGUgYSBzaWduaW5nIGtleSBhbmQgc3RvcmUgdGhlIHZhbHVlcyBpbiBtb2R1bGUtbGV2ZWwgdmFyaWFibGVzIGZvcgovLyBsYXRlciB1c2UgaW4gY3JlYXRpbmcgYWNjZXNzIHRva2VucwpjbGllbnQuc2lnbmluZ0tleXMuY3JlYXRlKHsKICAgIGZyaWVuZGx5TmFtZTogJ1NpZ25hbCBWaWRlbyBUZXN0Jwp9LCBmdW5jdGlvbihlcnIsIGRhdGEpIHsKICAgIC8vIGZpcmUgdGhlIGNhbGxiYWNrIHJpZ2h0IGF3YXkgb24gZXJyb3IKICAgIGlmIChlcnIpIHJldHVybiBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBzaWduaW5nIGtleSEnKTsKCiAgICAvLyBTdG9yZSByZXR1cm5lZCB2YWx1ZXMgZnJvbSBBUEkKICAgIFNJR05JTkdfS0VZX1NJRCA9IGRhdGEuc2lkOwogICAgU0lHTklOR19LRVlfU0VDUkVUID0gZGF0YS5zZWNyZXQ7CiAgICBjb25zb2xlLmxvZygnU2lnbmluZyBrZXlzIGdlbmVyYXRlZC4nKTsKfSk7CgovLyBNaWRkbGV3YXJlIGZ1bmN0aW9uIHRvIGFkZCBjYXBhYmlsaXR5IHRva2VuIGFuZCBlbmRwb2ludCBkYXRhIHRvIHRoZSAKLy8gcmVuZGVyaW5nIGNvbnRleHQgZm9yIGEgcmVzcG9uc2UKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihyZXF1ZXN0LCByZXNwb25zZSwgbmV4dCkgewogICAgdmFyIHRva2VuID0gbmV3IHR3aWxpby5BY2Nlc3NUb2tlbigKICAgICAgICAvLyBTaWQgZm9yIHRoZSBzaWduaW5nIGtleSB3ZSBnZW5lcmF0ZWQgb24gaW5pdAogICAgICAgIFNJR05JTkdfS0VZX1NJRCwKICAgICAgICAvLyB5b3VyIHJlZ3VsYXIgYWNjb3VudCBTSUQKICAgICAgICBwcm9jZXNzLmVudi5UV0lMSU9fQUNDT1VOVF9TSUQKICAgICk7CgogICAgLy8gQ3JlYXRlIGEgcmFuZG9tIGVuZHBvaW50IElECiAgICB2YXIgZW5kcG9pbnQgPSB1dWlkLnYxKCk7CgogICAgLy8gQWRkIHRoZSBjYXBhYmlsaXRpZXMgZm9yIGNvbnZlcnNhdGlvbiBlbmRwb2ludHMgdG8gdGhpcyB0b2tlbiwgaW5jbHVkaW5nCiAgICAvLyBpdCdzIHVuaXF1ZSBuYW1lLiBXZSdsbCB1c2UgdGhlIGRlZmF1bHQgcGVybWlzc2lvbiBzZXQgb2YgImxpc3RlbiIgYW5kIAogICAgLy8gImludml0ZSIKICAgIHRva2VuLmFkZEVuZHBvaW50R3JhbnQoZW5kcG9pbnQpOwoKICAgIC8vIEF1dGhvcml6ZSB0aGUgY2xpZW50IHRvIHVzZSBUd2lsaW8ncyBOQVQgdHJhdmVyc2FsIHNlcnZpY2UgLSBmb3IgdGhhdCwKICAgIC8vIGl0IHdpbGwgbmVlZCBhY2Nlc3MgdG8gdGhlICJUb2tlbnMiIHJlc291cmNlCiAgICB2YXIgcmVzVXJsID0gJ2h0dHBzOi8vYXBpLnR3aWxpby5jb20vMjAxMC0wNC0wMS9BY2NvdW50cy8lcy9Ub2tlbnMuanNvbic7CiAgICB2YXIgZ3JhbnRVcmwgPSB1dGlsLmZvcm1hdChyZXNVcmwsIHByb2Nlc3MuZW52LlRXSUxJT19BQ0NPVU5UX1NJRCk7CiAgICB0b2tlbi5hZGRHcmFudChncmFudFVybCk7CgogICAgLy8gR2VuZXJhdGUgYSBKV1QgdG9rZW4gc3RyaW5nIHRoYXQgd2lsbCBiZSBzZW50IHRvIHRoZSBicm93c2VyIGFuZCB1c2VkCiAgICAvLyBieSB0aGUgQ29udmVyc2F0aW9ucyBTREsKICAgIHZhciBzdHJpbmdUa24gPSB0b2tlbi50b0p3dChTSUdOSU5HX0tFWV9TRUNSRVQpOwoKICAgIC8vIEFkZCBnZW5lcmF0ZWQgdmF1ZXMgYXMgbG9jYWxzIGZvciB3aGVuIHdlIHJlbmRlciBvdXIgdGVtcGxhdGUKICAgIHJlc3BvbnNlLmxvY2Fscy5lbmRwb2ludElkID0gZW5kcG9pbnQ7CiAgICByZXNwb25zZS5sb2NhbHMudG9rZW4gPSBzdHJpbmdUa247CiAgICBuZXh0KCk7Cn07</textarea>
<textarea class="saurus-file" data-file="views/detail.jade" data-mode="jade">ZXh0ZW5kcyBsYXlvdXQKCmJsb2NrIGNvbnRlbnQKICBoMT0gdGl0bGUKICAucm93CiAgICAuY29sLXNtLTYKICAgICAgcAogICAgICAgIGEoaHJlZj0nLycpICZsdDsmbHQ7IFZpZXcgQWxsIFNoaXBzCiAgICAgIGluY2x1ZGUgX3NoaXBfZGV0YWlsCiAgICAuY29sLXNtLTYudmlkZW8KICAgICAgYnV0dG9uI2hlbHAuYnRuLmJ0bi1wcmltYXJ5IE5lZWQgSGVscD8gQ2hhdCB3aXRoIFN1cHBvcnQgTm93IQogICAgICBpbmNsdWRlIF92aWRlbwoKYmxvY2sgc2NyaXB0cwogIHNjcmlwdChzcmM9Jy9qcy9wcm9kdWN0LmpzJykKICAK</textarea>
<textarea class="saurus-file" data-file="views/_video.jade" data-mode="jade">LnZpZGVvLXdpZGdldAogIGRpdi5tYWluCiAgZGl2Lm1lCgovLy0gQWRkIFR3aWxpbyB2aWRlbyBTREsgZnJvbSBDRE4Kc2NyaXB0KHNyYz0naHR0cDovL21lZGlhLnR3aWxpb2Nkbi5jb20vc2RrL2NvbnZlcnNhdGlvbnMvdjAuNy9qcy9yZWxlYXNlcy8wLjcuMy5iMS05NTFlNGVkL3R3aWxpby1jb252ZXJzYXRpb25zLm1pbi5qcycpCgovLy0gUmVuZGVyIHRlbXBsYXRlIHZhcmlhYmxlcyBpbnRvIHNjcmlwdCB0YWdzLCBzbyB3ZSBjYW4gYWNjZXNzIGZyb20gb3VyCi8vLSBKYXZhU2NyaXB0IGNvZGUKc2NyaXB0IT0gJ3dpbmRvdy5lbmRwb2ludElkID0gIicgKyBlbmRwb2ludElkICsgJyI7JwpzY3JpcHQhPSAnd2luZG93LnRva2VuID0gIicgKyB0b2tlbiArICciOycKCi8vLSBJbmNsdWRlIHNoYXJlZCBjb2RlIHRvIHJ1biB2aWRlbyB3aWRnZXQKc2NyaXB0KHNyYz0nL2pzL3ZpZGVvLmpzJykKICAK</textarea>
<textarea class="saurus-file" data-file="public/js/product.js" data-mode="javascript">Ly8gR2V0IGEgcXVlcnkgcGFyYW1ldGVyIGZyb20gdGhlIGN1cnJlbnQgcGFnZQpmdW5jdGlvbiBnZXRQYXJhbWV0ZXJCeU5hbWUobmFtZSkgewogICAgbmFtZSA9IG5hbWUucmVwbGFjZSgvW1xbXS8sICJcXFsiKS5yZXBsYWNlKC9bXF1dLywgIlxcXSIpOwogICAgdmFyIHJlZ2V4ID0gbmV3IFJlZ0V4cCgiW1xcPyZdIiArIG5hbWUgKyAiPShbXiYjXSopIiksCiAgICAgICAgcmVzdWx0cyA9IHJlZ2V4LmV4ZWMobG9jYXRpb24uc2VhcmNoKTsKICAgIHJldHVybiByZXN1bHRzID09PSBudWxsID8gIiIgOiBkZWNvZGVVUklDb21wb25lbnQocmVzdWx0c1sxXS5yZXBsYWNlKC9cKy9nLCAiICIpKTsKfQoKJChmdW5jdGlvbigpIHsKICAgIHZhciBpbml0aWFsID0gJ05lZWQgSGVscD8gQ2hhdCB3aXRoIFN1cHBvcnQgTm93ISc7CiAgICB2YXIgd2FpdGluZyA9ICdXYWl0aW5nIGZvciB0aGUgbmV4dCBhdmFpbGFibGUgYWdlbnQuLi4nOwogICAgdmFyICRoZWxwID0gJCgnI2hlbHAnKTsKCiAgICAkaGVscC5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7CiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICRoZWxwLmh0bWwod2FpdGluZyk7CgogICAgICAgIC8vIENyZWF0ZSBzdXBwb3J0IHJlcXVlc3QKICAgICAgICAkLmFqYXgoewogICAgICAgICAgICB1cmw6ICcvdGlja2V0cycsCiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLAogICAgICAgICAgICBkYXRhOiB7CiAgICAgICAgICAgICAgICBlbmRwb2ludDogd2luZG93LmVuZHBvaW50SWQsCiAgICAgICAgICAgICAgICBwcm9kdWN0VXJsOiBnZXRQYXJhbWV0ZXJCeU5hbWUoJ3VybCcpCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicKICAgICAgICB9KS5kb25lKGZ1bmN0aW9uKGRhdGEpIHsKICAgICAgICAgICAgYWxlcnQoZGF0YS5tZXNzYWdlKTsKICAgICAgICB9KS5mYWlsKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAkaGVscC5odG1sKGluaXRpYWwpOwogICAgICAgICAgICBhbGVydCgnT29wcyEgVGhlcmUgd2FzIGEgcHJvYmxlbS4gUGxlYXNlIHRyeSBhZ2Fpbi4nKTsKICAgICAgICB9KTsKICAgIH0pOwoKICAgIC8vIGhpZGUgYnV0dG9uIGFuZCBzaG93IHZpZGVvIHdoZW4gYW4gaW52aXRhdGlvbiBoYXMgYmVlbiBhY2NlcHRlZAogICAgJChkb2N1bWVudCkub24oJ2ludml0ZUFjY2VwdGVkJywgZnVuY3Rpb24oKSB7CiAgICAgICAgJGhlbHAuaGlkZSgpOwogICAgICAgICQoJy52aWRlby13aWRnZXQnKS5zaG93KCk7CiAgICB9KTsKCiAgICAkKGRvY3VtZW50KS5vbignY29udmVyc2F0aW9uTGVmdCcsIGZ1bmN0aW9uKCkgewogICAgICAgICQoJy52aWRlby13aWRnZXQnKS5oaWRlKCk7CiAgICAgICAgJGhlbHAuaHRtbChpbml0aWFsKTsKICAgICAgICAkaGVscC5zaG93KCk7CiAgICB9KTsKfSk7</textarea>
<textarea class="saurus-file" data-file="public/js/video.js" data-mode="javascript">Ly8gQ3JlYXRlIHdpbmRvdy1zY29wZSB2YXJpYWJsZSBmb3Igc3VwcG9ydCBjb252bwp2YXIgc3VwcG9ydENvbnZlcnNhdGlvbjsKCi8vIGluY29taW5nIG9yIG91dGdvaW5nLCBkaXNwbGF5IHN0cmVhbXMgb24gc2NyZWVuCmZ1bmN0aW9uIHNob3dWaWRlb1N0cmVhbXMoY29udmVyc2F0aW9uKSB7CiAgICBzdXBwb3J0Q29udmVyc2F0aW9uID0gY29udmVyc2F0aW9uOwoKICAgIC8vIEF0dGFjaCB0byBET00KICAgIGNvbnZlcnNhdGlvbi5sb2NhbE1lZGlhLmF0dGFjaCgnLm1lJyk7CgogICAgLy8gTGlzdGVuIGZvciBwYXJ0aWNpcGFudHMKICAgIGNvbnZlcnNhdGlvbi5vbigncGFydGljaXBhbnRDb25uZWN0ZWQnLCBmdW5jdGlvbihwYXJ0aWNpcGFudCkgewogICAgICAgIHBhcnRpY2lwYW50Lm1lZGlhLmF0dGFjaCgnLm1haW4nKTsKICAgIH0pOwoKICAgIGNvbnZlcnNhdGlvbi5vbigncGFydGljaXBhbnREaXNjb25uZWN0ZWQnLCBmdW5jdGlvbihwYXJ0aWNpcGFudCkgewogICAgICAgIGNvbnZlcnNhdGlvbi5sb2NhbE1lZGlhLnN0b3AoKTsKICAgICAgICBjb252ZXJzYXRpb24ubGVhdmUoKTsKICAgICAgICAkKCcudmlkZW8td2lkZ2V0JykuaGlkZSgpOwogICAgfSk7Cn0KCi8vIEluaXRpYWxpemUgdHdpbGlvIHZpZGVvIGNvbXBvbmVudHMKJChmdW5jdGlvbigpIHsKCiAgICAvLyBDcmVhdGUgdmlkZW8gZW5kcG9pbnQgd2l0aCB0b2tlbiBnZW5lcmF0ZWQgb24gc2VydmVyCiAgICB2YXIgZW5kcG9pbnQgPSBuZXcgVHdpbGlvLkVuZHBvaW50KHdpbmRvdy50b2tlbik7CgogICAgLy8gQXV0b21hdGljYWxseSBhY2NlcHQgYW55IGluY29taW5nIGNhbGxzCiAgICBlbmRwb2ludC5vbignaW52aXRlJywgZnVuY3Rpb24oaW52aXRhdGlvbikgewogICAgICAgICQoZG9jdW1lbnQpLnRyaWdnZXIoJ2ludml0ZUFjY2VwdGVkJywgZW5kcG9pbnQpOwogICAgICAgIGludml0YXRpb24uYWNjZXB0KCkudGhlbihzaG93VmlkZW9TdHJlYW1zKTsKICAgIH0pOwoKICAgIC8vIEZpcmUgZXZlbnQgb24gdGhlIGRvY3VtZW50IHdpdGggZW5kcG9pbnQgd2hlbiBjcmVhdGVkCiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewogICAgICAgICQoZG9jdW1lbnQpLnRyaWdnZXIoJ2VuZHBvaW50Q3JlYXRlZCcsIGVuZHBvaW50KTsKICAgIH0sMSk7CgogICAgLy8gTGlzdGVuIGZvciBpbmNvbWluZyBjYWxscwogICAgZW5kcG9pbnQubGlzdGVuKCk7Cn0pOw==</textarea>
<textarea class="saurus-file" data-file="public/js/ticket.js" data-mode="javascript">JChmdW5jdGlvbigpIHsKICAgIC8vIEltbWVkaWF0ZWx5IHNob3cgdmlkZW8gd2lkZ2V0CiAgICAkKCcudmlkZW8td2lkZ2V0Jykuc2hvdygpOwoKICAgIC8vIEltbWVkaWF0ZWx5IGluaXRpYXRlIG91dGJvdW5kIGNhbGwgdG8gdGhlIGVuZHBvaW50CiAgICAkKGRvY3VtZW50KS5vbignZW5kcG9pbnRDcmVhdGVkJywgZnVuY3Rpb24oZSwgZW5kcG9pbnQpIHsKICAgICAgICBlbmRwb2ludC5jcmVhdGVDb252ZXJzYXRpb24odGlja2V0RW5kcG9pbnQpLnRoZW4oc2hvd1ZpZGVvU3RyZWFtcyk7CiAgICB9KTsKCiAgICAvLyBPbiBoYW5ndXAsIGp1c3QgaGlkZSB2aWRlbyB3aWRnZXQKICAgICQoZG9jdW1lbnQpLm9uKCdjb252ZXJzYXRpb25MZWZ0JywgZnVuY3Rpb24oKSB7CiAgICAgICAgJCgnLnZpZGVvLXdpZGdldCcpLmhpZGUoKTsKICAgIH0pOwp9KTs=</textarea>
</div>
</div><div class="saurus-overview"><ul></ul></div></div><div class="saurus-code"><div class="file-path"><span class="crumb-container"></span><i class="fa fa-fw fa-folder"></i></div><div class="saurus-editor"></div></div><div class="saurus-explorer"><div class="saurus-file-list"></div></div></div></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min.js"></script><script src="ace/ace.js"></script><script src="ace/theme-monokai.js"></script><script src="viewsaurus.js"></script></body></html>