<!DOCTYPE html><html><head><title>Customer Service with Twilio Video</title><style>body, html {
  height:100%;
  width:100%;
  padding:0;
  margin:0;
  overflow:hidden;
  background-color:#ddd;
}
.wrapper {
  height:100%;
  width:100%;
}</style><link rel="shortcut icon" href="//twilio.com/bundles/marketing/img/favicons/favicon.ico"><link rel="apple-touch-icon" href="//twilio.com/bundles/marketing/img/favicons/favicon_57.png"><link rel="apple-touch-icon" sizes="72x72" href="//twilio.com/bundles/marketing/img/favicons/favicon_72.png"><link rel="apple-touch-icon" sizes="114x114" href="//twilio.com/bundles/marketing/img/favicons/favicon_114.png"><link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css"><link rel="stylesheet" href="viewsaurus.css"></head><body><div class="wrapper"><div id="viewsaurus" data-title="Customer Service with Twilio Video"><div class="saurus-panes"><div class="saurus-prose"><div class="saurus-prose-header"><div class="title-outer"><span class="step-title">Customer Service with Twilio Video</span></div></div><div class="saurus-nav-buttons"><div class="saurus-nav-button nav-overview"><div class="saurus-nav-button-inner"><i class="fa fa-fw fa-list"></i></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-previous"><div class="saurus-nav-button-inner"><a href=""> <i class="fa fa-fw fa-play fa-rotate-180"></i></a></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-next clickable"><div class="saurus-nav-button-inner"><a href="#1"> <i class="fa fa-fw fa-play"></i></a></div></div><div class="saurus-next-title"><span class="next-title-inner"></span></div></div><div class="saurus-progress-bar"></div><div class="saurus-start"><p>In this tutorial, we'll show you the code necessary to create amazing in-context customer support experiences using Twilio Video. Let's get started!</p><a href="#0">Start Tutorial</a></div><div class="saurus-content"><div data-title="Customer Service with Twilio Video" class="chapter"><div data-title="Customer Service with Twilio Video" class="step"><h2 id="customer-service-with-twilio-video">Customer Service with Twilio Video</h2>
<p>In this tutorial, we&#39;ll dive into the code necessary to implement in-context customer support with Twilio Video. In this demo application, a customer will request live video support while viewing a product page on our website. In a separate &quot;support agent&quot; UI, we will display all current requests for support, and allow our agents to reach out directly and assist our customers.</p>
<h3 id="demo-screencast">Demo Screencast</h3>
<p>Check out the video below to see this use case in action.</p>
<p>TODO</p>
<p>Look like fun? Let's figure out how it works! Click the <i class="fa fa-fw fa-play"></i> button above to move on to the next step of the tutorial.
</p></div><div data-title="Building Blocks" class="step"><h2 id="api-building-blocks">API Building Blocks</h2>
<p>To create this customer service application, we&#39;ll be using the following Twilio APIs:</p>
<ul>
<li><a href="&#39;#&#39;">Twilio JavaScript SDK</a>: This SDK makes managing real-time video conversations via WebRTC very simple.</li>
<li><a href="&#39;https://www.twilio.com/docs/client/capability-tokens&#39;">Capability Tokens</a>: To enable our browser-based users to make use of our Twilio account, we need to issue them a signed capability token indicating what each user can do.</li>
</ul>
<p>Let&#39;s take a look at the ingredients in this sample application next.</p>
</div><div data-title="About This Application" data-file="package.json" data-highlight="27-41" class="step"><h2 id="about-this-application">About This Application</h2>
<p>This web application was built with <a href="http://nodejs.org">Node.js</a> and the popular <a href="http://expressjs.com">Express</a> web framework, along with a few other useful open source components. We&#39;re going to save our support requests in <a href="http://www.mongodb.com/">MongoDB</a> with the help of <a href="http://mongoosejs.com/">Mongoose</a>, a handy module for creating <a href="http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller">model</a> objects that are saved in MongoDB.</p>
<p>Of course, we&#39;ll also be using Twilio&#39;s module for Node.js, as well as Twilio&#39;s JavaScript SDK in the browser.</p>
<h3 id="run-it-now">Run It Now</h3>
<p>Want to run it yourself right now? Deploy this app to your Heroku account using the button below:</p>
<p><a href="https://heroku.com/deploy?template=https://github.com/TwilioDevEd/video-service-node"><img src="https://www.herokucdn.com/deploy/button.png" alt="Deploy"></a></p>
<p>Now that we have a better sense of what&#39;s in the box, let&#39;s move on to building the customer-facing portion of this application. </p>
</div></div><div data-title="Customer View: Requesting Video Support" class="chapter"><div data-title="Requesting Live Video Support" data-file="controllers/router.js" class="step"><h2 id="requesting-live-video-support">Requesting Live Video Support</h2>
<p>Let&#39;s begin our exploration of live video support by looking at the customer-facing side of this application.  Here&#39;s how that interaction works at a high level (click to make it bigger):</p>
<p><img src="//s3.amazonaws.com/howtodocs/video-service-customer-flow.png" alt="//s3.amazonaws.com/howtodocs/video-service-customer-flow.png"></p>
<p>At a high level, our user must:</p>
<ol>
<li>Visit a product page</li>
<li>Click a button to request live support</li>
<li>Wait for the next available agent</li>
</ol>
<p>Let&#39;s take a look at the code necessary to drive each step of this experience.</p>
</div><div data-title="Choosing a Product" data-file="controllers/router.js" data-highlight="20-21" class="step"><h2 id="choosing-a-product">Choosing a Product</h2>
<p>Our example product catalog is a list of starships fetched via the <a href="http://swapi.co/api/starships/">Star Wars API</a>.</p>
<p>We won&#39;t dive into this code in any great detail, but we&#39;ll use this API both to display a list of starships to the User, and to show them details about an individual ship. You might have one of these master-detail UIs in your existing application.</p>
<p>The Express route highlighted here will display a table of links that the User can choose from to show a detail page, where they will be able to request support. When you&#39;re making a big purchase like an Incom T-65 X-Wing Starfighter, that&#39;s definitely a time when you&#39;d value high-touch support.</p>
<p><img src="//s3.amazonaws.com/howtodocs/xwing-blueprint.jpg" alt="//s3.amazonaws.com/howtodocs/xwing-blueprint.jpg"></p>
</div><div data-title="Rendering a Product Page: The Route" data-file="controllers/router.js" data-highlight="23-24" class="step"><h2 id="rendering-a-product-page-the-route">Rendering a Product Page: The Route</h2>
<p>This route will handle requests for all the individual product pages. There&#39;s a controller function <code>products.detail</code> which handles actually fetching product details from the Star Wars API, and including them on the rendered page.</p>
<p>However, we&#39;re more interested in the <code>token</code> <a href="http://expressjs.com/guide/using-middleware.html">middleware function</a>, which will generate a &quot;capability token&quot; that enables any viewer of the page to receive an incoming video call. Let&#39;s dive into that code now.</p>
</div><div data-title="Rendering a Product Page: Token Middleware" data-file="middleware/token.js" class="step"><h2 id="rendering-a-product-page-the-token-middleware">Rendering a Product Page: The Token Middleware</h2>
<p>This middleware function will be executed before every product page is rendered. It will use Twilio&#39;s helper library for Node.js to generate a one-time use token that allows a connected browser to receive incoming calls. It also generates a unique ID for this client using the <code>uuid</code> module - we&#39;ll use this as the &quot;phone number&quot; for our customer, where we know we can reach them later.</p>
<p>Let&#39;s jump up to the client-side now, where we can see how this token is used on the product page.</p>
</div><div data-title="Rendering a Product Page: The Template" data-file="views/detail.jade" class="step"><h2 id="rendering-a-product-page-the-template">Rendering a Product Page: The Template</h2>
<p>To render the product page, we will make use of two partial templates, <code>_ship_detail</code> and <code>_video</code>. The former will display information about the current ship. The latter will embed a video chat widget which will be used both on our customer&#39;s product detail page, and on the support agent&#39;s page (which we&#39;ll look at later).</p>
<p>Let&#39;s check out this partial template to see what it looks like.</p>
</div><div data-title="Video Partial" data-file="views/_video.jade" class="step"><h2 id="video-partial">Video Partial</h2>
<p>This template creates the HTML <code>video</code> elements that our two conversation participants will be shown in. It also creates some simple UI that will allow us to mute and hang up our video call.</p>
</div><div data-title="Inserting Capability Tokens and Customer's Unique ID" data-file="views/_video.jade" data-highlight="11-15" class="step"><h2 id="inserting-capability-tokens-and-customer-s-unique-id">Inserting Capability Tokens and Customer&#39;s Unique ID</h2>
<p>What might not be completely obvious, though, is what&#39;s happening here. With these statements, we&#39;re writing in values generated on the server (our capability token and unique ID for this customer) into JavaScript strings that will be evaluated once the page is loaded.</p>
<p>We&#39;ll go into how these values are used in depth soon, but let&#39;s finish out our look at the customer UI by showing how a support request gets created.</p>
</div><div data-title="Creating a Ticket" data-file="public/js/product.js" data-highlight="14-33" class="step"><h2 id="creating-a-ticket">Creating a Ticket</h2>
<p>On our product detail page, we load up some JavaScript that will listen for a click event on the &quot;Request Support&quot; button. This will fire off an Ajax request to the server, which will create a new support ticket in our database.  That ticket will contain both the URL for the product our customer is viewing, as well as their unique ID which we assigned on the server. </p>
<p>By capturing these values in a support ticket, our agents will be able to provide a better support experience when they finally reach out - they&#39;ll know what product the customer is looking at, and how to contact them via video chat.</p>
<p>Let&#39;s switch over to the agent side of things to see how the video support call actually gets created.</p>
</div></div><div data-title="Agent View: Answering Support Calls" class="chapter"><div data-title="Answering a Support Request" data-file="controllers/router.js" class="step"><h2 id="answering-a-support-request">Answering a Support Request</h2>
<p>Now that we&#39;ve seen how a customer can request video support, let&#39;s take a look at how we answer that request and initiate a video call.  Here&#39;s how the interaction works at a high level (click to make it bigger):</p>
<p><img src="//s3.amazonaws.com/howtodocs/video-service-agent-flow.png" alt="//s3.amazonaws.com/howtodocs/video-service-agent-flow.png"></p>
<p>Our agent will view a page for a support ticket, and the JavaScript running on that page will immediately try and connect to the customer with a video call.  The agent will also be able to view the same product details as the customer, so they can provide informed support based on where the customer is inside the application</p>
<p>Let&#39;s take a look at the code necessary to drive each step of this experience.</p>
</div><div data-title="Agent UI Routes" data-file="controllers/router.js" data-highlight="26-30" class="step"><h2 id="agent-ui-routes">Agent UI Routes</h2>
<p>To power our agent experience, we need to handle two routes - one for the list of support requests, and another to display an individual support request. Much like the product list, we won&#39;t delive too deeply into how the list of tickets is displayed. We&#39;re reading the tickets out of a database and displaying them in an HTML table.</p>
<p>Let&#39;s begin instead by looking at how we render a ticket page, the second of these two routes. We use the same <code>token</code> middleware as before to create an ID for our agent. We also fetch data from the Star Wars API to get information on the ship the current customer is viewing.</p>
<p>Most of the action for the call is happening on the client side, though, so let&#39;s dive into the browser code to see what&#39;s going on!</p>
</div><div data-title="Initializing the Twilio JavaScript SDK" data-file="public/js/video.js" class="step"><h2 id="initializing-the-twilio-javascript-sdk">Initializing the Twilio JavaScript SDK</h2>
<p>UNDER CONSTRUCTION</p>
</div><div data-title="Making an Outbound Call" data-file="public/js/ticket.js" class="step"><h2 id="making-an-outbound-call">Making an Outbound Call</h2>
<p>UNDER CONSTRUCTION</p>
</div><div data-title="Accepting an Inbound Call" data-file="public/js/video.js" class="step"><h2 id="accepting-an-inbound-call">Accepting an Inbound Call</h2>
<p>UNDER CONSTRUCTION</p>
</div><div data-title="Displaying Video Streams" data-file="public/js/video.js" class="step"><h2 id="displaying-video-streams">Displaying Video Streams</h2>
<p>UNDER CONSTRUCTION</p>
</div><div data-title="Controlling Your Local Stream" data-file="public/js/video.js" class="step"><h2 id="controlling-your-local-stream">Controlling Your Local Stream</h2>
<p>UNDER CONSTRUCTION</p>
</div><div data-title="All Done!" data-file="public/js/video.js" class="step"><h2 id="all-done-">All Done!</h2>
<p>And with a fraction of the code and none of the infrastructure you would need to roll your own WebRTC-powered video call, we&#39;ve integrated live, in-context video support into our application. And this is just the beginning - you could combine this API with <a href="https://www.twilio.com/taskrouter">TaskRouter</a> for more advanced work distribution for your agents, and begin to leverage other WebRTC features not used here.</p>
<p>We&#39;d love to hear what you thought of this tutorial. Hit us up <a href="https://twitter.com/twilio">on Twitter @twilio</a> or <a href="mailto:help@twilio.com">send us a note</a>. Thanks for reading!</p>
</div></div>
<div class="saurus-files" style="display:none;"><textarea class="saurus-file" data-file="package.json" data-mode="json">ewogICJuYW1lIjogInZpZGVvLXNlcnZpY2Utbm9kZSIsCiAgInZlcnNpb24iOiAiMS4wLjAiLAogICJkZXNjcmlwdGlvbiI6ICJEZW1vIGFwcCBzaG93aW5nIHZpZGVvLXBvd2VyZWQgY3VzdG9tZXIgc2VydmljZSB3aXRoIFR3aWxpbyBmb3IgTm9kZS5qcyB1c2luZyB0aGUgRXhwcmVzcyB3ZWIgZnJhbWV3b3JrIiwKICAibWFpbiI6ICJpbmRleC5qcyIsCiAgInNjcmlwdHMiOiB7CiAgICAidGVzdCI6ICJtb2NoYSB0ZXN0IgogIH0sCiAgInJlcG9zaXRvcnkiOiB7CiAgICAidHlwZSI6ICJnaXQiLAogICAgInVybCI6ICJodHRwczovL2dpdGh1Yi5jb20vVHdpbGlvRGV2RWQvdmlkZW8tc2VydmljZS1ub2RlIgogIH0sCiAgImtleXdvcmRzIjogWwogICAgInR3aWxpbyIsCiAgICAiZXhwcmVzcyIsCiAgICAibW9uZ29kYiIsCiAgICAidHdpbWwiLAogICAgIndlYmhvb2tzIiwKICAgICJ2b2lwIgogIF0sCiAgImF1dGhvciI6ICJLZXZpbiBXaGlubmVyeSIsCiAgImxpY2Vuc2UiOiAiTUlUIiwKICAiYnVncyI6IHsKICAgICJ1cmwiOiAiaHR0cHM6Ly9naXRodWIuY29tL1R3aWxpb0RldkVkL3ZpZGVvLXNlcnZpY2Utbm9kZS9pc3N1ZXMiCiAgfSwKICAiaG9tZXBhZ2UiOiAiaHR0cHM6Ly9naXRodWIuY29tL1R3aWxpb0RldkVkL3ZpZGVvLXNlcnZpY2Utbm9kZSIsCiAgImRlcGVuZGVuY2llcyI6IHsKICAgICJib2R5LXBhcnNlciI6ICJeMS4xMi4wIiwKICAgICJjb25uZWN0LWZsYXNoIjogIl4wLjEuMSIsCiAgICAiZXhwcmVzcyI6ICJeNC4xMi4wIiwKICAgICJleHByZXNzLXNlc3Npb24iOiAiXjEuMTAuMyIsCiAgICAiaHR0cC1hdXRoIjogIl4yLjIuNSIsCiAgICAiamFkZSI6ICJeMS45LjIiLAogICAgIm1vbWVudCI6ICJeMi4xMC4yIiwKICAgICJtb25nb29zZSI6ICJeNC4wLjIiLAogICAgIm1vcmdhbiI6ICJeMS41LjEiLAogICAgInJlcXVlc3QiOiAiXjIuNTUuMCIsCiAgICAidHdpbGlvIjogIl4xLjExLjEiLAogICAgInVuZGVyc2NvcmUuc3RyaW5nIjogIl4zLjAuMyIsCiAgICAidXVpZCI6ICJeMi4wLjEiCiAgfSwKICAiZGV2RGVwZW5kZW5jaWVzIjogewogICAgImNoYWkiOiAiXjIuMS4wIiwKICAgICJtb2NoYSI6ICJeMi4xLjAiCiAgfSwKICAiZW5naW5lcyI6IHsKICAgICJub2RlIjogIj49IDAuMTAuMCIKICB9Cn0K</textarea>
<textarea class="saurus-file" data-file="controllers/router.js" data-mode="javascript">dmFyIHMgPSByZXF1aXJlKCd1bmRlcnNjb3JlLnN0cmluZycpOwp2YXIgbW9tZW50ID0gcmVxdWlyZSgnbW9tZW50Jyk7CnZhciBwcm9kdWN0cyA9IHJlcXVpcmUoJy4vcHJvZHVjdHMnKTsKdmFyIHN1cHBvcnRUaWNrZXRzID0gcmVxdWlyZSgnLi9zdXBwb3J0X3RpY2tldHMnKTsKdmFyIHRva2VuID0gcmVxdWlyZSgnLi4vbWlkZGxld2FyZS90b2tlbicpOwoKLy8gTWFwIHJvdXRlcyB0byBjb250cm9sbGVyIGZ1bmN0aW9ucwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGFwcCkgewogICAgLy8gSW5jbHVkZSBzdHJpbmcgZm9ybWF0IGhlbHBlcnMKICAgIGFwcC5sb2NhbHMubnVtID0gZnVuY3Rpb24obnVtLCBkaWdpdHMpIHsKICAgICAgICB2YXIgc2lnRGlnaXRzID0gTnVtYmVyKGRpZ2l0cyk7CiAgICAgICAgaWYgKGlzTmFOKHNpZ0RpZ2l0cykpIHNpZ0RpZ2l0cyA9IDI7CiAgICAgICAgcmV0dXJuIHMubnVtYmVyRm9ybWF0KE51bWJlcihudW0pLCBzaWdEaWdpdHMpOwogICAgfTsKCiAgICBhcHAubG9jYWxzLnRpbWVBZ28gPSBmdW5jdGlvbih0aW1lKSB7CiAgICAgICAgcmV0dXJuIG1vbWVudCh0aW1lKS5mcm9tTm93KHRydWUpOwogICAgfTsKCiAgICAvLyBSZW5kZXIgaG9tZSBwYWdlIChwcm9kdWN0IGxpc3QpCiAgICBhcHAuZ2V0KCcvJywgcHJvZHVjdHMubGlzdCk7CgogICAgLy8gUHJvZHVjdCBkZXRhaWwgcGFnZSwgd2hpY2ggc2hvdWxkIGluY2x1ZGUgYSBjYXBhYmlsaXR5IHRva2VuCiAgICBhcHAuZ2V0KCcvcHJvZHVjdHMnLCB0b2tlbiwgcHJvZHVjdHMuZGV0YWlsKTsKCiAgICAvLyBWaWV3IGFsbCBzdXBwb3J0IHRpY2tldHMKICAgIGFwcC5nZXQoJy90aWNrZXRzJywgc3VwcG9ydFRpY2tldHMubGlzdCk7CgogICAgLy8gU2hvdyBhIHZpZGVvIGNvbnZlcnNhdGlvbiB2aWV3IGZvciBhIHRpY2tldAogICAgYXBwLmdldCgnL3RpY2tldHMvOmlkJywgdG9rZW4sIHN1cHBvcnRUaWNrZXRzLnNob3cpOwoKICAgIC8vIENyZWF0ZSBhIHN1cHBvcnQgdGlja2V0CiAgICBhcHAucG9zdCgnL3RpY2tldHMnLCBzdXBwb3J0VGlja2V0cy5jcmVhdGUpOwp9Ow==</textarea>
<textarea class="saurus-file" data-file="middleware/token.js" data-mode="javascript">dmFyIHR3aWxpbyA9IHJlcXVpcmUoJ3R3aWxpbycpOwp2YXIgdXVpZCA9IHJlcXVpcmUoJ3V1aWQnKTsKdmFyIGNvbmZpZyA9IHJlcXVpcmUoJy4uL2NvbmZpZycpOwp2YXIgY2xpZW50ID0gdHdpbGlvKGNvbmZpZy5hY2NvdW50U2lkLCBjb25maWcuYXV0aFRva2VuKTsKCi8vIE1pZGRsZXdhcmUgZnVuY3Rpb24gdG8gYWRkIGNhcGFiaWxpdHkgdG9rZW4gYW5kIGVuZHBvaW50IGRhdGEgdG8gdGhlIAovLyByZW5kZXJpbmcgY29udGV4dCBmb3IgYSByZXNwb25zZQptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHJlcXVlc3QsIHJlc3BvbnNlLCBuZXh0KSB7CiAgICAvLyBHZW5lcmF0ZSBhIGNhcGFiaWxpdHkgdG9rZW4gZm9yIHRoZSBjbGllbnQKICAgIHZhciBjYXBhYmlsaXR5ID0gbmV3IHR3aWxpby5DYXBhYmlsaXR5KGNvbmZpZy5hY2NvdW50U2lkLCBjb25maWcuYXV0aFRva2VuKTsKCiAgICAvLyBCZXRhIG9ubHkgLSBuZWVkIHRoaXMgdmFsdWUgZm9yIG5vdywgdG8gYmUgcmVtb3ZlZCBpbiBhIGZ1dHVyZQogICAgLy8gdmlkZW8gcmVsZWFzZQogICAgY2FwYWJpbGl0eS5hbGxvd0NsaWVudE91dGdvaW5nKCdBUDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwJyk7CgogICAgLy8gQ3JlYXRlIGEgdW5pcXVlIElEIGZvciBhIHZpZGVvICJlbmRwb2ludCIgdGhhdCBpZGVudGlmaWVzIHRoaXMKICAgIC8vIGN1c3RvbWVyJ3MgYnJvd3NlciB3aW5kb3cuIFJpZ2h0IG5vdywganVzdCB1c2luZyBhIHJhbmRvbSBzdHJpbmcuCiAgICAvLyBUaGlzIHdpbGwgYWxsb3cgdGhlIGN1c3RvbWVyIHRvIHJlY2VpdmUgaW5jb21pbmcgdmlkZW8gY2FsbHMuCiAgICB2YXIgZW5kcG9pbnQgPSB1dWlkLnYxKCk7CiAgICBjYXBhYmlsaXR5LmFsbG93Q2xpZW50SW5jb21pbmcoZW5kcG9pbnQpOwoKICAgIC8vIENyZWF0ZSBhIE5BVCB0cmF2ZXJzYWwgdG9rZW4KICAgIGNsaWVudC50b2tlbnMuY3JlYXRlKGZ1bmN0aW9uKGVyciwgcmVzcCkgewogICAgICAgIC8vIEFkZCB0aGUgY2FwYWJpbGl0eSB0b2tlbiBhbmQgZW5kcG9pbnQgSUQgdG8gdGhlIHJlbmRlcmluZyBjb250ZXh0CiAgICAgICAgcmVzcG9uc2UubG9jYWxzLmVuZHBvaW50SWQgPSBlbmRwb2ludDsKICAgICAgICByZXNwb25zZS5sb2NhbHMuaWNlU2VydmVycyA9IHJlc3AuaWNlU2VydmVyczsKICAgICAgICByZXNwb25zZS5sb2NhbHMudG9rZW4gPSBjYXBhYmlsaXR5LmdlbmVyYXRlKCk7CiAgICAgICAgbmV4dCgpOwogICAgfSk7Cn07</textarea>
<textarea class="saurus-file" data-file="views/detail.jade" data-mode="jade">ZXh0ZW5kcyBsYXlvdXQKCmJsb2NrIGNvbnRlbnQKICBoMT0gdGl0bGUKICAucm93CiAgICAuY29sLW1kLTYKICAgICAgcAogICAgICAgIGEoaHJlZj0nLycpICZsdDsmbHQ7IFZpZXcgQWxsIFNoaXBzCiAgICAgIGluY2x1ZGUgX3NoaXBfZGV0YWlsCiAgICAuY29sLW1kLTYudmlkZW8KICAgICAgYnV0dG9uI2hlbHAuYnRuLmJ0bi1wcmltYXJ5IE5lZWQgSGVscD8gQ2hhdCB3aXRoIFN1cHBvcnQgTm93IQogICAgICBpbmNsdWRlIF92aWRlbwoKYmxvY2sgc2NyaXB0cwogIHNjcmlwdChzcmM9Jy9qcy9wcm9kdWN0LmpzJykKICAK</textarea>
<textarea class="saurus-file" data-file="views/_video.jade" data-mode="jade">LnZpZGVvLXdpZGdldAogIHZpZGVvLm1haW4KICB2aWRlby5tZQogIC5jb250cm9scy5idG4tZ3JvdXAuYnRuLWdyb3VwLXhzCiAgICBidXR0b24jbXV0ZS5idG4uYnRuLWRlZmF1bHQgTXV0ZQogICAgYnV0dG9uI2hhbmd1cC5idG4uYnRuLWRhbmdlciBFbmQgQ2FsbAoKLy8tIEFkZCBUd2lsaW8gdmlkZW8gU0RLIGZyb20gQ0ROCnNjcmlwdChzcmM9Jy8vbWVkaWEudHdpbGlvY2RuLmNvbS9zZGsvY29udmVyc2F0aW9ucy92MC42L2pzL3JlbGVhc2VzLzAuNi4xLmIxLWQ5ODFjMjgvdHdpbGlvLWNvbnZlcnNhdGlvbnMuanMnKQoKLy8tIFJlbmRlciB0ZW1wbGF0ZSB2YXJpYWJsZXMgaW50byBzY3JpcHQgdGFncywgc28gd2UgY2FuIGFjY2VzcyBmcm9tIG91cgovLy0gSmF2YVNjcmlwdCBjb2RlCnNjcmlwdCE9ICd3aW5kb3cuZW5kcG9pbnRJZCA9ICInICsgZW5kcG9pbnRJZCArICciOycKc2NyaXB0IT0gJ3dpbmRvdy50b2tlbiA9ICInICsgdG9rZW4gKyAnIjsnCnNjcmlwdCE9ICd3aW5kb3cuaWNlU2VydmVycyA9IFwnJyArIEpTT04uc3RyaW5naWZ5KGljZVNlcnZlcnMpICsgJ1wnOycKCi8vLSBJbmNsdWRlIHNoYXJlZCBjb2RlIHRvIHJ1biB2aWRlbyB3aWRnZXQKc2NyaXB0KHNyYz0nL2pzL3ZpZGVvLmpzJykKICAK</textarea>
<textarea class="saurus-file" data-file="public/js/product.js" data-mode="javascript">Ly8gR2V0IGEgcXVlcnkgcGFyYW1ldGVyIGZyb20gdGhlIGN1cnJlbnQgcGFnZQpmdW5jdGlvbiBnZXRQYXJhbWV0ZXJCeU5hbWUobmFtZSkgewogICAgbmFtZSA9IG5hbWUucmVwbGFjZSgvW1xbXS8sICJcXFsiKS5yZXBsYWNlKC9bXF1dLywgIlxcXSIpOwogICAgdmFyIHJlZ2V4ID0gbmV3IFJlZ0V4cCgiW1xcPyZdIiArIG5hbWUgKyAiPShbXiYjXSopIiksCiAgICAgICAgcmVzdWx0cyA9IHJlZ2V4LmV4ZWMobG9jYXRpb24uc2VhcmNoKTsKICAgIHJldHVybiByZXN1bHRzID09PSBudWxsID8gIiIgOiBkZWNvZGVVUklDb21wb25lbnQocmVzdWx0c1sxXS5yZXBsYWNlKC9cKy9nLCAiICIpKTsKfQoKJChmdW5jdGlvbigpIHsKICAgIHZhciBpbml0aWFsID0gJ05lZWQgSGVscD8gQ2hhdCB3aXRoIFN1cHBvcnQgTm93ISc7CiAgICB2YXIgd2FpdGluZyA9ICdXYWl0aW5nIGZvciB0aGUgbmV4dCBhdmFpbGFibGUgYWdlbnQuLi4nOwogICAgdmFyICRoZWxwID0gJCgnI2hlbHAnKTsKCiAgICAkaGVscC5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7CiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICRoZWxwLmh0bWwod2FpdGluZyk7CgogICAgICAgIC8vIENyZWF0ZSBzdXBwb3J0IHJlcXVlc3QKICAgICAgICAkLmFqYXgoewogICAgICAgICAgICB1cmw6ICcvdGlja2V0cycsCiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLAogICAgICAgICAgICBkYXRhOiB7CiAgICAgICAgICAgICAgICBlbmRwb2ludDogd2luZG93LmVuZHBvaW50SWQsCiAgICAgICAgICAgICAgICBwcm9kdWN0VXJsOiBnZXRQYXJhbWV0ZXJCeU5hbWUoJ3VybCcpCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicKICAgICAgICB9KS5kb25lKGZ1bmN0aW9uKGRhdGEpIHsKICAgICAgICAgICAgYWxlcnQoZGF0YS5tZXNzYWdlKTsKICAgICAgICB9KS5mYWlsKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAkaGVscC5odG1sKGluaXRpYWwpOwogICAgICAgICAgICBhbGVydCgnT29wcyEgVGhlcmUgd2FzIGEgcHJvYmxlbS4gUGxlYXNlIHRyeSBhZ2Fpbi4nKTsKICAgICAgICB9KTsKICAgIH0pOwoKICAgIC8vIGhpZGUgYnV0dG9uIGFuZCBzaG93IHZpZGVvIHdoZW4gYW4gaW52aXRhdGlvbiBoYXMgYmVlbiBhY2NlcHRlZAogICAgJChkb2N1bWVudCkub24oJ2ludml0ZUFjY2VwdGVkJywgZnVuY3Rpb24oKSB7CiAgICAgICAgJGhlbHAuaGlkZSgpOwogICAgICAgICQoJy52aWRlby13aWRnZXQnKS5zaG93KCk7CiAgICB9KTsKCiAgICAkKGRvY3VtZW50KS5vbignY29udmVyc2F0aW9uTGVmdCcsIGZ1bmN0aW9uKCkgewogICAgICAgICQoJy52aWRlby13aWRnZXQnKS5oaWRlKCk7CiAgICAgICAgJGhlbHAuaHRtbChpbml0aWFsKTsKICAgICAgICAkaGVscC5zaG93KCk7CiAgICB9KTsKfSk7</textarea>
<textarea class="saurus-file" data-file="public/js/video.js" data-mode="javascript">Ly8gQ3JlYXRlIHdpbmRvdy1zY29wZSB2YXJpYWJsZSBmb3Igc3VwcG9ydCBjb252bwp2YXIgc3VwcG9ydENvbnZlcnNhdGlvbjsKCi8vIGluY29taW5nIG9yIG91dGdvaW5nLCBkaXNwbGF5IHN0cmVhbXMgb24gc2NyZWVuCmZ1bmN0aW9uIHNob3dWaWRlb1N0cmVhbXMoY29udmVyc2F0aW9uKSB7CiAgICAvLyBzaG93IGxvY2FsIHZpZGVvCiAgICB2YXIgbG9jYWxWaWRlb0VsZW1lbnQgPSAkKCcubWUnKS5nZXQoMCk7CgogICAgLy8gY3JlYXRlIGEgbG9jYWxTdHJlYW0gb2JqZWN0IHRvIG11dGUgYW5kIGVuZAogICAgc3VwcG9ydENvbnZlcnNhdGlvbiA9IGNvbnZlcnNhdGlvbjsKICAgIGNvbnZlcnNhdGlvbi5sb2NhbFN0cmVhbS5hdHRhY2gobG9jYWxWaWRlb0VsZW1lbnQpOwoKICAgIGNvbnZlcnNhdGlvbi5vbigncGFydGljaXBhbnRDb25uZWN0ZWQnLCBmdW5jdGlvbihwYXJ0aWNpcGFudCkgewogICAgICAgIC8vIHNob3cgcGFydGljaXBhbnQgdmlkZW8KICAgICAgICB2YXIgcmVtb3RlVmlkZW9FbGVtZW50ID0gJCgnLm1haW4nKS5nZXQoMCk7CiAgICAgICAgcGFydGljaXBhbnQuc3RyZWFtLmF0dGFjaChyZW1vdGVWaWRlb0VsZW1lbnQpOwogICAgfSk7Cn0KCi8vIEluaXRpYWxpemUgdHdpbGlvIHZpZGVvIGNvbXBvbmVudHMKJChmdW5jdGlvbigpIHsKICAgIHZhciBpY2UgPSBKU09OLnBhcnNlKGljZVNlcnZlcnMpOwoKICAgIC8vIENyZWF0ZSBlbmRwb2ludCBmb3IgY3VycmVudCBwZXJzb24sIHVzaW5nIHRoZSBjYXBhYmlsaXR5IHRva2VuCiAgICAvLyBhbHJlYWR5IGNyZWF0ZWQgaW4gdGhlIHdpbmRvdyBzY29wZQogICAgbmV3IFR3aWxpby5FbmRwb2ludC5jcmVhdGVXaXRoVG9rZW4odG9rZW4sIHsKICAgICAgICBkZWJ1ZzogdHJ1ZSwKICAgICAgICBpY2VTZXJ2ZXJzOiBpY2UKICAgIH0pLnRoZW4oZnVuY3Rpb24oZW5kcG9pbnQpIHsKICAgICAgICAvLyBhdXRvbWF0aWNhbGx5IGFuc3dlciBhbnkgaW5jb21pbmcgY2FsbHMKICAgICAgICBlbmRwb2ludC5vbignaW52aXRlJywgZnVuY3Rpb24oaW52aXRlKSB7CiAgICAgICAgICAgIGludml0ZS5hY2NlcHQoKS50aGVuKGZ1bmN0aW9uKGNvbnZlcnNhdGlvbikgewogICAgICAgICAgICAgICAgJChkb2N1bWVudCkudHJpZ2dlcignaW52aXRlQWNjZXB0ZWQnKTsKICAgICAgICAgICAgICAgIHNob3dWaWRlb1N0cmVhbXMoY29udmVyc2F0aW9uKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSk7CgogICAgICAgIC8vIEZpcmUgZXZlbnQgb24gdGhlIGRvY3VtZW50IHdpdGggZW5kcG9pbnQgd2hlbiBjcmVhdGVkCiAgICAgICAgJChkb2N1bWVudCkudHJpZ2dlcignZW5kcG9pbnRDcmVhdGVkJywgZW5kcG9pbnQpOwoKICAgIH0sIGZ1bmN0aW9uKGVycm9yKSB7CiAgICAgICAgYWxlcnQoJ1NvcnJ5LCB0aGVyZSB3YXMgYSBwcm9ibGVtIGNvbm5lY3RpbmcgdG8gVHdpbGlvIDooJyk7CiAgICB9KTsKCiAgICAvLyBWaWRlbyBjb250cm9scwogICAgdmFyIG11dGVkID0gZmFsc2U7CiAgICB2YXIgJG11dGUgPSAkKCcjbXV0ZScpOwogICAgJG11dGUub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7CiAgICAgICAgc3VwcG9ydENvbnZlcnNhdGlvbi5sb2NhbFN0cmVhbS5tdXRlZCA9ICFtdXRlZDsKICAgICAgICBtdXRlZCA9ICFtdXRlZDsKICAgICAgICAkbXV0ZS5odG1sKChtdXRlZCkgPyAnVW5tdXRlJyA6ICdNdXRlJyk7CiAgICB9KTsKCiAgICAkKCcjaGFuZ3VwJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7CiAgICAgICAgc3VwcG9ydENvbnZlcnNhdGlvbi5sZWF2ZSgpOwogICAgICAgICQoZG9jdW1lbnQpLnRyaWdnZXIoJ2NvbnZlcnNhdGlvbkxlZnQnKTsKICAgIH0pOwp9KTs=</textarea>
<textarea class="saurus-file" data-file="public/js/ticket.js" data-mode="javascript">JChmdW5jdGlvbigpIHsKICAgIC8vIEltbWVkaWF0ZWx5IHNob3cgdmlkZW8gd2lkZ2V0CiAgICAkKCcudmlkZW8td2lkZ2V0Jykuc2hvdygpOwoKICAgIC8vIEltbWVkaWF0ZWx5IGluaXRpYXRlIG91dGJvdW5kIGNhbGwgdG8gdGhlIGVuZHBvaW50CiAgICAkKGRvY3VtZW50KS5vbignZW5kcG9pbnRDcmVhdGVkJywgZnVuY3Rpb24oZSwgZW5kcG9pbnQpIHsKICAgICAgICBlbmRwb2ludC5jcmVhdGVDb252ZXJzYXRpb24odGlja2V0RW5kcG9pbnQpCiAgICAgICAgICAgIC5kb25lKHNob3dWaWRlb1N0cmVhbXMsIGZ1bmN0aW9uKGVycm9yKSB7CiAgICAgICAgICAgIC8vIEZhaWxlZCB0byBzZXQgdXAgb3V0Ym91bmQgY2FsbAogICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvci5zdGFjayk7CiAgICAgICAgICAgIGFsZXJ0KCdTb3JyeSwgY291bGQgbm90IGNyZWF0ZSBvdXRib3VuZCBjYWxsIDooJyk7CiAgICAgICAgfSk7CiAgICB9KTsKCiAgICAvLyBPbiBoYW5ndXAsIGp1c3QgaGlkZSB2aWRlbyB3aWRnZXQKICAgICQoZG9jdW1lbnQpLm9uKCdjb252ZXJzYXRpb25MZWZ0JywgZnVuY3Rpb24oKSB7CiAgICAgICAgJCgnLnZpZGVvLXdpZGdldCcpLmhpZGUoKTsKICAgIH0pOwp9KTs=</textarea>
</div>
</div><div class="saurus-overview"><ul></ul></div></div><div class="saurus-code"><div class="file-path"><span class="crumb-container"></span><i class="fa fa-fw fa-folder"></i></div><div class="saurus-editor"></div></div><div class="saurus-explorer"><div class="saurus-file-list"></div></div></div></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min.js"></script><script src="ace/ace.js"></script><script src="ace/theme-monokai.js"></script><script src="viewsaurus.js"></script></body></html>